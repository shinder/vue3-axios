<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>使用 Axios - POST</title>
    <link rel="stylesheet" href="css/edit.css" />
  </head>
  <body>
    <h2>使用 Axios - POST - 新增通訊錄資料</h2>
    <form name="form1" onsubmit="mySubmit(event)" onkeyup="showData()">
      <label for="name">姓名:</label>
      <input type="text" id="name" name="name" value="王小明" />
      <br />
      <label for="email">Email:</label>
      <input type="email" id="email" name="email" value="wang@test.com" />
      <br />
      <label for="mobile">手機:</label>
      <input type="text" id="mobile" name="mobile" value="0935123456" />
      <br />
      <label for="birthday">生日:</label>
      <input type="date" id="birthday" name="birthday" value="1995-08-15" />
      <br />
      <label for="address">地址:</label>
      <input type="text" id="address" name="address" value="宜蘭縣" />
      <br />
      <button type="submit">新增</button>
    </form>
    <br />
    結果：<br />
    <pre id="info"></pre>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="js/axios-api-common.js"></script>
    <script>
      const info = document.querySelector("#info");

      // 顯示將要送出的資料
      function showData() {
        const form = document.form1;
        const myData = {
          name: form.name.value,
          email: form.email.value,
          mobile: form.mobile.value,
          birthday: form.birthday.value,
          address: form.address.value,
        };
        console.log(myData);
        return myData;
      }
      showData(); // 頁面載入時顯示一次

      async function mySubmit(e) {
        e.preventDefault(); // 避免以預設方式送出表單（阻止表單預設提交行為）
        const myData = showData(); // 取得將要送出的資料
        try {
          const response = await api.post("/address_book", myData);
          info.textContent = JSON.stringify(response.data, null, 2);
        } catch (error) {
          info.textContent = "Error: " + error;
        }
      }
    </script>
  </body>
</html>
